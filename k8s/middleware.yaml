# Traefik Middleware Resources
#
# These resources require the Traefik CRD (Custom Resource Definition) to be installed
# in your Kubernetes cluster. To use these middlewares:
#
# 1. Ensure your Traefik installation supports CRDs (traefik.io/v1alpha1 or traefik.containo.us/v1alpha1)
# 2. Apply this file: kubectl apply -f k8s/middleware.yaml
# 3. Uncomment the middleware annotation in k8s/ingress.yaml
# 4. Reapply the ingress: kubectl apply -f k8s/ingress.yaml

---
# Middleware to strip the /webui prefix before routing to the Vue app
# This allows the Vue app to be served at /webui/* while internally handling requests as if at root
# For example: /webui/about → stripped to /about → Vue SPA serves index.html
apiVersion: traefik.io/v1alpha1
kind: Middleware
metadata:
  name: stripprefix-webui
  namespace: default
spec:
  stripPrefix:
    prefixes:
      - /webui
